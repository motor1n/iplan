![iplan-icon](./pic/iplan-logo.png 'iPlan')

---

# Краткая характеристика
* Наименование программы: **iPlan** (individual plan) - индивидуальный план работы преподавателя.
* Назначение программы: программа предназначена для **автоматизации** составления индивидуального плана работы преподавателя.
* Конечные пользователи: **преподаватели вуза**.

# Техническое задание
В начале учебного года каждый преподаватель вуза получает [файл](./ex/source-data.xlsx "Нагрузка преподавателя на учебный год") в формате электронной таблицы **.xlsx** с нагрузкой на текущий учебный год. На основании полученных данных требуется составить **индивидуальный план работы преподавателя**. Данный план включает два вида учебной нагрузки:

+ учебная;
+ внеучебная.

**Учебная** нагрузка заполняется строго в соответствии с данными xlsx-файла. **Внеучебная** нагрузка определяется самим преподавателем в соответствии с текущими целями и научными интересами. Она включает следующие виды работ:

+ учебно-методическая;
+ организационная;
+ научно-исследовательская;
+ воспитательная;
+ повышение квалификации.

Заполнение индивидуального плана происходит в **два этапа**:

1. **Планирование** (сентябрь, начало учебного года) - заполняются все поля относящиеся к планированию предстоящей деятельности.
2. **Отчёт** (июнь, конец учебного года) - заполняются фактически выполненные часы на конец учебного года.

Причём, в соответствии с **требованиями руководства**, материалы первого этапа "Планирование" должны быть оформлены в формате документа **.docx**, согласно утверждённого [образца](./ex/individ-plan.docx "Образец индивидуального плана"). Отчётные поля документа на данном этапе **не заполняются** и остаются пустыми вплоть до отчёного периода.

На втором этапе "Отчёт" документ .docx должен быть распечатан в виде **твёрдой копии**. Все пустующие поля с количеством фактически выполненных часов должны быть заполнены, но уже в **рукописном виде**. После чего документ рассматривает заведующий кафедрой, а также учебный отдел, и в итоге составляется **заключение** о выполнении плана.

# Сборка и запуск
Разработка и тестирование программы было осуществлено в операционной системе **Manjaro Linux 20.2 Nibia**. Для успешного запуска и нормальной работы должно быть установлено следующее программное обеспечение:

+ язык **Python 3.8.6**
+ библиотека **PyQt 5.15.2**
+ библиотека **docxtpl 0.10.0**
+ библиотека **xlrd 1.2.0**

# Функциональные возможности
Программа **iPlan** автоматизирует заполнение индивидуального плана преподавателя, получая на вход исходные данный в формате **Microsof Excel (xlsx)**, и формируя конечный документ в формате **Microsoft Word (docx)**.

При помощи **iPlan** полностью **автоматизируется** распределение и заполнение **учебной работы**, исходя из нагрузки преподавателя на текущий учебный год. Распределение **внеучебной нагрузки** осуществляется в **полуавтоматическом** режиме потому, что реализовать это в автоматическом режиме не представляется возможным из-за **вариативности** выбора видов деятельности, которые преподаватель планирует, исходя из своих **личных** целей.

# Интерфейс программы
## Функциональные зоны
После старта окно программы выглядит следующим образом.

![screen-01](./pic/screen-01.png 'Окно программы после старта')

Оно состоит из пяти функциональных **зон**:

**1**. Учебная работа &rarr; ввод исходных данных.

**2**. Внеучебная работа &rarr; выбор видов работы.

**3**. Внеучебная работа &rarr; таблица с полуавтоматическим заполнением данных.

**4**. Краткая помощь &rarr; порядок заполнения индивидуального плана.

**5**. Сохранение документа &rarr; кнопка "Сохранить..." и прогресс-бар.

Программа выстроена так, что новая зона для ввода данных становится **активна** только после того, как будет **заполнена** текущая. Сразу после старта, активной является только зона №**1**.

## Зона №1: Учебная работа
В этой зоне пользователь должен **выбрать** свои данные из предлагаемых:

+ фамилия, имя, отчество;
+ учёная степень, звание;
+ должность;
+ кафедра;
+ дата избрания по конкурсу;
+ текущий учебный год.

После ввода данных станет активна кнопка:

![screen-02](./pic/screen-02.png 'Активная кнопка "Открыть"')

Следует открыть [файл](./ex/source-data.xlsx "Нагрузка преподавателя на учебный год") учебной нагрузки .xlsx, **выданный** преподавателю. После выбора файла учебной нагрузки станет активна зона "Внеучебная работа"

## Внеучебная работа
### Зона №2: Выбор видов работы
Внеучебная работа содержит в своём составе **пять вкладок** с видами работы:

![screen-03](./pic/screen-03.png 'Вкладки с видами внеучебной работы')

В каждой из этих вкладок, следует выбирать те виды внеучебной работы, которые **требуются** преподавателю для занесения их в индивидуальный учебный план. Делать это следует отмечая **чекбокс** (квадратик) в начале строки.

![screen-04](./pic/screen-04.png 'Выбор видов внеучебной работы')

После выбора видов учебной работы следует **записать** их в таблицу, нажав кнопку:

![screen-05](./pic/screen-05.png 'Кнопка "Записать в таблицу"')

### Зона №3: Таблица ввода
Выбранные на предыдущем шаге данные, **разместятся** в таблице.

![screen-06](./pic/screen-06.png 'Выбраные данные в таблице')

При этом **автоматически** заполнятся столбцы:

+ виды работы;
+ трудоёмкость;
+ форма отчётности.

**Ручной ввод** потребуется только для тех столбцов, где важен **выбор** самого преподавателя:

+ срок выполнения;
+ запланировано;

![](./pic/info-icon.png) Таблица вкладки "Научно-исследовательская" **отличается** от остальных таблиц тем, что содержит ещё один столбец "Объём п.л. или стр.".

![screen-07](./pic/screen-07.png 'Таблица вкладки "Научно-исследовательская"')

Данный столбец также заполняется **пользователем**, следует обратить на это внимание.

## Зона №4: Краткая помощь
Данная зона предназначена для того, чтобы пользователь начал пользоваться программой **без чтения** дополнительной документации. Кроме того, информация зоны "Краткая помощь" находится всегда перед глазами, поэтому её можно рассматривать, как, своего рода, **памятку** по работе с программой.

![screen-08](./pic/screen-08.png 'Краткая помощь по работе с программой')

## Зона №5: Сохранение документа
Кнопка "Сохранить..." становится активной только тогда, когда **все ячейки**, предназначенные для обязательного ввода, **заполнены**.

![screen-09](./pic/screen-09.png 'Интерфейс программы после заполнения всех полей')

Сохранение конечного документа производится в соответствии с требованиями руководства в формате **Microsoft Word (docx)**.
Ход рендеринга данных в документ и его сохранение отображается в виде **прогресс-бара** под кнопкой.

![screen-10](./pic/screen-10.png 'Прогресс-бар')

# Перспективы развития
После выполнения основного технического задания, в программу планируется добавить следующие **функциональные элементы**:

+ Загрузка данных не из отдельного файла преподавателя, а из общего файла нагрузки по всем преподавателям.
+ Улучшение интерфейса: выбираемые виды работы автоматически отображаются в таблице, а отключаемые чекбоксы автоматически удаляются из таблицы, что упраздняет кнопку "Записать в таблицу".
+ Добавление контроля соотношения часов по утверждённым правилам: 
    - учебная работа &le; 60%
    - научная и учебно-методическая &ge; 30%
    - организационная и воспитательная &le; 20%
+ Оперативные рекомендации пользователю в случае некорректного соотношения часов: в каком виде работы избыток или недостаток часов.
+ Создание дополнительного модуля "Месячная ведомость" для контроля и отчёта о проделанной работе в течение текущего месяца.
